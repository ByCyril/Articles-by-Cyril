<!DOCTYPE html>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
    <title>Logistic Regression with SciKit-Learn</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <link rel="stylesheet" href="../assets/css/main.css" />
    <link rel="shortcut icon" href="../images/boy.png" />

    <meta name="twitter:card" content="summary" />

    <meta name="twitter:creator" content="@cyrilivargarcia" />
    <meta
      property="og:url"
      content="https://articlesbycyril.com/statistics/logistic-regression-with-scikit-learn.html"
    />
    <meta property="og:title" content="Logistic Regression with SciKit-Learn" />
    <meta
      property="og:description"
      content="Logistic regression is another type of regression analysis. Learn how to perform the analysis in SciKit-Learn"
    />
    <meta
      property="og:image"
      content="https://articlesbycyril.com/images/boy.png"
    />
  </head>
  <body class="is-preload">
    <!-- Wrapper -->
    <div id="wrapper">
      <!-- Main -->
      <div id="main">
        <div class="inner">
          <!-- Header -->
          <header id="header">
            <a href="#" class="logo"><strong>Articles</strong> by Cyril</a>
            <ul class="icons">
              <li>
                <a
                  href="https://twitter.com/cyrilivargarcia"
                  class="icon fa-twitter"
                  ><span class="label">Twitter</span></a
                >
              </li>
              <li>
                <a
                  href="https://www.linkedin.com/in/cyrilivargarcia/"
                  class="icon fa-linkedin"
                  ><span class="label">LinkedIn</span></a
                >
              </li>
              <li>
                <a
                  href="https://github.com/cyrilivargarcia"
                  class="icon fa-github"
                  ><span class="label">GitHub</span></a
                >
              </li>

              <li>
                <a href="https://bycyril.com/" class="icon fa-html5"
                  ><span class="label">Web</span></a
                >
              </li>
            </ul>
          </header>

          <!-- Content -->
          <section>
            <header class="main">
              <h1>Logistic Regression with SciKit-Learn</h1>
            </header>

            <span class="image main"
              ><img
                src="https://cdn-images-1.medium.com/max/960/1*UgYbimgPXf6XXxMy2yqRLw.png"
                alt=""
            /></span>
            <section>
              <h3 align="right" id="stats"></h3>
            </section>
            <h2>Introduction</h2>
            <p>
              I’ve written articles about Simple Linear Regression and Multiple
              Linear Regression. Another type of regression analysis is called a
              logistic regression. Like all simple and multiple regression
              analysis, logistic regression is also a predictive analysis. The
              only difference is that while simple and multiple regression
              returns a quantitative response, logistic regression returns a
              binary response (success/failure, yes/no, 1/0).
            </p>
            <p>
              We will model the success probability as
              <code>p = P(response = 1)</code>. The value <code>p</code> will
              depend on a quantitative predictor
              <code>p = P(response = 1)</code>, so <code>p = p(X)</code>.
              Logistic regression is modeled by the sigmoid curve; and while
              there are many solutions for the problem, the most common solution
              is the logit function. Since <code>p(X)</code> will return the
              probability of success, we will set <code>p(x)</code> to the logit
              function.
            </p>
            <p>
              In this article, I’m going to use SciKit-Learn to perform the
              regression analysis on a problem. The problem I’m attempting to
              solve was an example given by my Professor at San Jose State
              University.
            </p>

            <hr class="major" />

            <h2>Problem</h2>
            <p>
              The <i>Challenger</i> disaster in January 1986 was caused by the
              failure of an O-ring. The incidence could have been prevented
              because data on failure of these O-rings (as a function outside
              air temperature) was available at the time of the shuttle launch.
            </p>
            <p>On the morning of January 28, 1986 the air temperature was
                    about 31°F. Even though this value is outside the range of
                    observed temperatures, use the logit model to predict the
                    probability of O-ring failure for the Challenger flight.
                    </p>
            <h3>Data</h3>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    <th>Temperature</th>
                    <th>Success/Failure <code>0 = success 1 = failure</code></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>53.0</td>
                    <td>1.0</td>
                  </tr>
                  <tr>
                    <td>56.0</td>
                    <td>1.0</td>
                  </tr>
                  <tr>
                    <td>57.0</td>
                    <td>1.0</td>
                  </tr>
                  <tr>
                    <td>.</td>
                    <td>.</td>
                  </tr>

                  <tr></tr>
                  <tr>
                    <td>.</td>
                    <td>.</td>
                  </tr>

                  <tr>
                    <td>80.0</td>
                    <td>0.0</td>
                  </tr>
                  <tr>
                    <td>81.0</td>
                    <td>0.0</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>
              X will be our temperature in a 2D array and our response will be
              our variable y, which is also a 2D array.
            </p>
            <pre><code>X = [[53.0],[56.0],[57.0],[63.0],[66.0],[67.0],[67.0],[67.0],[68.0],[69.0],[70.0],[70.0],[70.0],[70.0],[72.0],[73.0],[75.0],[75.0],[76.0],[76.0],[78.0],[79.0],[80.0],[81.0]]
y = [[1.0],[1.0],[1.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[1.0],[0.0],[1.0],[0.0],[0.0],[0.0],[1.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0]]</code></pre>

            <h3>SciKit-Learn</h3>
            <p>
              Import our necessary Python packages. In this case, we only need
              SciKit-Learn. From SKLearn, we want to import
              <code>LogisticRegression()</code>
            </p>
            <pre><code>from sklearn.linear_model import LogisticRegression </code></pre>
            <p>
              Next, we want to create a logistic regression model with 2
              parameters: <code>C</code> and <code>solver</code>.
            </p>
            <p>
              <b>Solver:</b> According to the documentation, the solver
              parameter specifies the type of optimization algorithm. An
              optimization algorithm in mathematics is an iterative procedure
              that tries to find the best solution. In this example problem, we
              will use the <i>Broyden–Fletcher–Goldfarb–Shanno algorithm</i>. If
              you want to learn more about this algorithm, refer to this
              <a
                href="https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&ved=2ahUKEwj78rnm7_3hAhXUJjQIHWS4DCkQFjABegQIBBAB&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FBroyden%25E2%2580%2593Fletcher%25E2%2580%2593Goldfarb%25E2%2580%2593Shanno_algorithm&usg=AOvVaw2EdXi96HMValpKL83RrkIA"
                >wikipedia page</a
              >
              <p><b>C:</b> Allows us to specify the strength of the regularization. In other words, the higher the number, the closer the algorithm will try to get to the right prediction. However, setting a too-high of a number would cause your model to overfit. Too small would not reach the optimal solution. In this example, we'll try 25.</p>
            </p>
            <pre><code>model = LogisticRegression(C=25, solver='lbfgs')</code></pre>
            <p>Next, we want to fit our data to the model. We do this by simply using the <code>fit()</code> function.</p>
            <pre><code>model.fit(X,y)</code></pre>
            <h3>Run the Model</h3>
            <p>After running your code, we can grab the coefficients from our logistic regression model. We do this by using the <code>coef_</code> and <code>intercept_</code> functions.</p>
            <pre><code>m = model.coef_
b = model.intercept_
print(b,m)</code></pre>
<h5>Output</h5>
<pre><code>intercept_ = [11.74238757] coef_ = [[-0.18837235]]</code></pre>
<h3>Interpretation</h3>
<p>Based on the model, we can interpret that as temperature increases by one unit, the odds ration will change by a factor of <code>e**m</code>. In this case, <code>m = -0.18837235</code></p>
<h3>Answer the Question</h3>          
<p>The question, what is the probability of failure when the temperature outside is 31°F. Simply let p(31) = ? where X as our predictor equal to 31.</p>
<pre><code>model.predict_proba([[31]])</code></pre>
<h5>Output</h5>
<pre><code>0.99727578</code></pre>
<p>That means, there is a 99.7% chance of failure if the temperature outside is at 31°F. With that being said, it is no surprise that the challenger exploded in mid-flight. It would be surprising if it did not explode.</p>

<hr class='major'>
<h2>Final Thoughts</h2>
<p>This example covered logistic regression with one predictor. SciKit-Learn is capable of performing logistic regression with more than one predictor. The only difference we need to change is the solver, C, and the multi_class parameters.</p>
<hr class='major'>
<h2>References</h2>
<p>• <a href='https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html'>SciKit-Learn Logistic Regression Documentation</a></p>
<p>• <a href='http://www.med.mcgill.ca/epidemiology/joseph/courses/epib-621/logistic2.pdf'>Multivariate Logistic Regression</a></p>
<p>• <a href='https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&cad=rja&uact=8&ved=2ahUKEwi7z5nQ9f3hAhWzOn0KHXjaCZEQFjACegQIDxAL&url=https%3A%2F%2Fnathanbrixius.wordpress.com%2F2016%2F06%2F04%2Ffunctions-i-have-known-logit-and-sigmoid%2F&usg=AOvVaw1TCOFK4E_zRfT5PB4HBtPX'>Logit Function</a></p>
</section>
        </div>
      </div>

      <!-- Sidebar -->
      <div id="sidebar">
        <div class="inner">
          <!-- Menu -->
          <nav id="menu">
            <header class="major">
              <h2>Menu</h2>
            </header>
            <ul>
              <li><a href="../index.html">Home</a></li>
              <li><a href="../ios-engineering.html">iOS Engineering</a></li>
              <li>
                <a href="../artificial-intelligence.html"
                  >Artificial Intelligence</a
                >
              </li>
              <li>
                <a href="../statistics-and-data-science.html"
                  >Statistics and Data Science</a
                >
              </li>
              <li><a href="../blog.html">Blog</a></li>
            </ul>
          </nav>

          <!-- Section -->
          <section>
            <header class="major">
              <h2>Projects by Cyril</h2>
            </header>
            <div class="mini-posts">
              <article>
                <a href="#" class="image"
                  ><img src="../images/memo.jpeg" alt=""
                /></a>
                <h2>Memo</h2>
                <p>
                  Take and organize notes like text messages.
                </p>
              </article>
              <article>
                <a href="#" class="image"
                  ><img src="../images/geekweather.jpeg" alt=""
                /></a>
                <h2>GeekWeather</h2>

                <p>
                  A simple weather app with an aesthetically user interface.
                </p>
              </article>
              <article>
                <a href="#" class="image"
                  ><img src="../images/filestorks.jpeg" alt=""
                /></a>
                <h2>FileStorks.com</h2>

                <p>
                  A quick and easy way to share files.
                </p>
              </article>
            </div>
          </section>

          <!-- Section -->
          <section>
            <header class="major">
              <h2>Connect with me!</h2>
            </header>
            <p>
              Open to collaboration opportunities, topic suggestions, or any
              questions!
            </p>
            <ul class="contact">
              <li class="fa-envelope">
                <a href="#">garciacy at bycyril dot com</a>
              </li>
              <li class="fa-twitter">
                <a href="https://twitter.com/cyrilivargarcia"
                  >@cyrilivargarcia</a
                >
              </li>
              <li class="fa-linkedin">
                <a href="https://www.linkedin.com/in/cyrilivargarcia/"
                  >in/cyrilivargarcia</a
                >
              </li>
            </ul>
          </section>

          <!-- Footer -->
          <!-- Footer -->
          <footer id="footer">
            <p class="copyright">
              &copy; Website developed by <br />AJ aj@lkn.io | @ajlkn
              <br />
              <a href="https://html5up.net">HTML5 UP</a>.
            </p>
          </footer>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/js/browser.min.js"></script>
    <script src="../assets/js/breakpoints.min.js"></script>
    <script src="../assets/js/util.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.5.0/firebase.js"></script>
    <script src="../analytics/analytics.js"></script>
  </body>
</html>
