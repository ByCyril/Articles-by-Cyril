<!DOCTYPE html>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
    <title>Communication Patterns</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />
    <link rel="stylesheet" href="../assets/css/main.css" />
  </head>
  <body class="is-preload">
    <!-- Wrapper -->
    <div id="wrapper">
      <!-- Main -->
      <div id="main">
        <div class="inner">
          <!-- Header -->
          <header id="header">
            <a href="#" class="logo"><strong>Articles</strong> by Cyril</a>
            <ul class="icons">
              <li>
                <a
                  href="https://twitter.com/cyrilivargarcia"
                  class="icon fa-twitter"
                  ><span class="label">Twitter</span></a
                >
              </li>
              <li>
                <a
                  href="https://www.linkedin.com/in/cyrilivargarcia/"
                  class="icon fa-linkedin"
                  ><span class="label">LinkedIn</span></a
                >
              </li>
              <li>
                <a
                  href="https://github.com/cyrilivargarcia"
                  class="icon fa-github"
                  ><span class="label">GitHub</span></a
                >
              </li>

              <li>
                <a href="https://bycyril.com/" class="icon fa-html5"
                  ><span class="label">Web</span></a
                >
              </li>
            </ul>
          </header>

          <!-- Content -->
          <section>
            <header class="main">
              <h1>Communication Patterns</h1>
            </header>

            <span class="image main"
              ><img
                src="http://www.goodworklabs.com/wp-content/uploads/2017/08/3b_5-reasons-why-Swift-is-preferred-for-iOS-development.png"
                alt=""
            /></span>
            <h2>Introduction</h2>
            <p>
              Communication patterns is a way to pass information from one class
              to another. There are many types of patterns; often times asked
              questions in an iOS Engineering interview; particularly in their
              use cases and when would one be preferable over the other.
              Communication patterns generally shine in programming paradigms
              like Model View Controller or Model-View-ViewModel. In this
              article, I’m going to talk about two communication patterns:
              Notifications and Observers, and Protocols and Delegates. I will
              explain the theory of how they work and a simple example.
            </p>

            <hr class="major" />
            <h2>Notifications and Observers</h2>
            <p>
              Notifications and Observers is a one to many communication
              pattern. In other words, one class can communicate with many
              different classes. In my opinion, that in and of itself is a
              strength in its own right. The idea is that a class will send out
              a notification and one or more classes with an observer will
              listen for a particular notification to trigger a specific action.
            </p>
            <p>
              We do this by first posting a notification and setting a
              <code>Notification.Name</code> value. This will allow us to
              differentiate from other notifications in your app. We create an
              observer in the class that will listen for the notification by
              creating an <code>addObserver</code> property.
            </p>
            <p>
              In the following example, we have a
              <code>MainViewController</code> and a
              <code>DetailsViewController</code>. The
              <code>MainViewController</code> will post a notification through
              an <code>@IBAction</code> with a notification name called
              <i>SaveAction</i>.
            </p>
            <p>
              We then call the
              <code>NotificationCenter.default.post()</code> function and pass
              the notification name
            </p>

            <h4>Create the Notification</h4>
            <pre><code>
class MainViewController: UIViewController {

    @IBAction func saveAction() {
        // Create a notification name with the name <i>SaveAction</i>
        let notificationName = Notification.Name.init(rawValue: “SaveAction”)

        // Create a post while passing the notification name
        NotificationCenter.default.post(notificationName, object: nil)
    }
}
</code></pre>

            <h4>Create the observer</h4>
            <pre><code>
class DetailsViewController: UIViewController {

    override viewDidLoad() {
        super.viewDidLoad()

        // Create a notification name called <i>SaveAction</i>
        let notificationName = Notification.Name.init(“SaveAction”)

        // Create the observer while passing the notification name and the action you want to trigger 
        // when the notification is recieved.
        NotificationCenter.default.addObserver(self, selector: #selector(DetailsViewController.triggerAction), name: notificationName, object: nil)
    }

    @objc
    func triggerAction() {
        print(“Notification recieved, action has been triggered”)
    }
}
</code></pre>
            <p>
              Looking at this code with a blind eye would seem normal, however,
              behind this code is a problem. The
              <code>DetailsViewController</code> has created a
              <code>NotificationObserver</code> when the class is instantiated.
              However, after you leave the class, the
              <code>NotificationObserver</code> is still listening for
              notifications in-spite of the deallocation of the class. Ideally,
              you’d want that. However, when you visit the class a second time,
              it would create a new <code>NotificationObserver</code> on top of
              the previously created observer. <b>This is a memory leak</b>. To
              fix this, we simply remove the observer in a
              <code>deinit()</code> function from the
              <code>DetailsViewController</code>.
            </p>
            <pre><code>
deinit() {
    NotificationCenter.default.removeObserver(self)
}
            </code></pre>

            <hr class="major" />
            <h2>Protocols and Delegates</h2>
            <p>
              Another communication pattern is Protocols and Delegates. Unlike
              Notifications and observers that has a one to many communication
              patter, protocols and delegates is a one to one communication
              pattern. In my experience, I’ve used this type of pattern often by
              passing data back from one ViewController to the next.
            </p>
            <p>
              The idea is simple: The protocol is a separate class of predefined
              functions. The protocol is then inherited by a class which we will
              call <code>ClassA</code>; and the predefined functions in the
              protocol is defined inside <code>ClassA</code>. The second class
              we call <code>ClassB</code> will have a reference to the protocol
              from <code>ClassA</code> we call a delegate. We use this delegate
              to call the predefined functions from the protocol and pass any
              information necessary to <code>ClassA</code>. Let’s take a look at
              an example:
            </p>
            <p>
              Create the protocol called <code>ClassProtocols</code>,
              <code>ClassA</code>, and <code>ClassB</code>.
              <code>ClassA</code> will inherit the ClassProtocols. In doing so,
              we'd have to define the functions that have been predefined in our
              <code>ClassProtocols</code>. Lastly, we create a reference to
              <code>ClassB</code>
            </p>
            <p>
              Inside ClassB, we'd need a reference to the Protocol. This will be
              our delegate. We instantiate this delegate inside ClassA through
              our ClassB reference. Your code should look something like this.
            </p>
            <pre><code>
// 1) Create the protocol
protocol ClassProtocols {
    func setNumber(num: Int)
}

// 2) ClassA inherits the protocols
class ClassA: ClassProtocols {

// 3) Create a reference to ClassB
    var classB = ClassB()

    init() {
        // 7) Instantiate the delegate from ClassB
        classB.delegate = self
    }

// 4) Define the functions from the protocol
    func setNumber(num: Int) {
        print("Number recieved", num)
    }
}

class ClassB {

// 5) Create a reference to the protocol
    var delegate: ClassProtocols!

// 6a) Create a separate function
    func settingNumber() {
// 6b) Call the delegate and the predefined function and pass a value.
        delegate.setNumber(i: 10)
    }

}
            </code></pre>

            <hr class="major" />
            <h2>Conclusion</h2>
            <p>
              In my experience, while I know about notifications and observers,
              I never really used them in real applications. Mainly because I
              never had any reason to use notifications and observers. When I
              first applied it to real application, notifications and observers
              are generally easier to use but prone to memory leaks if not
              careful. If you find yourself struggling to understand these
              concepts, try applying them to an actual project.
            </p>
          </section>
        </div>
      </div>

      <!-- Sidebar -->
      <div id="sidebar">
        <div class="inner">
          <!-- Menu -->
          <nav id="menu">
            <header class="major">
              <h2>Menu</h2>
            </header>
            <ul>
              <li><a href="../index.html">Home</a></li>
              <li><a href="../ios-engineering.html">iOS Engineering</a></li>
              <li>
                <a href="../artificial-intelligence.html"
                  >Artificial Intelligence</a
                >
              </li>
              <li>
                <a href="../statistics-and-data-science.html"
                  >Statistics and Data Science</a
                >
              </li>
              <li><a href="../blog.html">Blog</a></li>
            </ul>
          </nav>

          <!-- Section -->
          <section>
            <header class="major">
              <h2>Projects by Cyril</h2>
            </header>
            <div class="mini-posts">
              <article>
                <a href="#" class="image"
                  ><img src="../images/memo.jpeg" alt=""
                /></a>
                <h2>Memo</h2>
                <p>
                  Take and organize notes like text messages.
                </p>
              </article>
              <article>
                <a href="#" class="image"
                  ><img src="../images/geekweather.jpeg" alt=""
                /></a>
                <h2>GeekWeather</h2>

                <p>
                  A simple weather app with an aesthetically user interface.
                </p>
              </article>
              <article>
                <a href="#" class="image"
                  ><img src="../images/filestorks.jpeg" alt=""
                /></a>
                <h2>FileStorks.com</h2>

                <p>
                  A quick and easy way to share files.
                </p>
              </article>
            </div>
          </section>

          <!-- Section -->
          <section>
            <header class="major">
              <h2>Connect with me!</h2>
            </header>
            <p>
              Open to collaboration opportunities, topic suggestions, or any
              questions!
            </p>
            <ul class="contact">
              <li class="fa-envelope">
                <a href="#">garciacy at bycyril dot com</a>
              </li>
              <li class="fa-twitter">
                <a href="https://twitter.com/cyrilivargarcia"
                  >@cyrilivargarcia</a
                >
              </li>
              <li class="fa-linkedin">
                <a href="https://www.linkedin.com/in/cyrilivargarcia/"
                  >in/cyrilivargarcia</a
                >
              </li>
            </ul>
          </section>

          <!-- Footer -->
          <!-- Footer -->
          <footer id="footer">
            <p class="copyright">
              &copy; Website developed by <br />AJ aj@lkn.io | @ajlkn
              <br />
              <a href="https://html5up.net">HTML5 UP</a>.
            </p>
          </footer>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/js/browser.min.js"></script>
    <script src="../assets/js/breakpoints.min.js"></script>
    <script src="../assets/js/util.js"></script>
    <script src="../assets/js/main.js"></script>
  </body>
</html>
